# Cross-Site Request Forgery (CSRF) Attacks
- Cross-Site Request Forgery (CSRF) is a common class of vulnerability that tricks a user into submitting a web request on behalf of an attacker.
- In many cases of CSRF, a malicious actor crafts a URL embedded with a request
- link shortening or embedding it into a phishing email to get an authenticated user to click on it
- CSRF attacks tend to target the web requests that are state-changing rather than requests that expect meaningful response data.
- State-changing requests could be: payment for a product, changing account information, transferring funds, changing security settings, and so on.
<br>
Example: <br>
Suppose our web application allows users to change their password via the following link, where [USER PASSWORD] would contain the new desired password.

```
https://oursite.com/changepassword.php?new_password=[USER PASSWORD]
```

If the developers didnâ€™t consider the impact of Cross-Site Request Forgery attacks, a threat actor may be able to create a new password link and send it to the user. When the user opens the link, they would initiate the password change, but with the attacker-supplied password! This would allow a hacker to take over their account!

## Preventing CSRF
- add a CSRF token
- This token is a unique value that is added to each request. This value is dynamically generated by the server and used to verify all requests.
- This token is kept strictly with the form the user is currently on if they were making the legitimate request
- If an application is vulnerable to Cross-Site Scripting (XSS) attack, a hacker could use their XSS attack to extract this token!
- As an extra layer of security, we can ask users to re-authenticate by manually enter additional information prior to a critical request.

![CSRF Prevention](https://static-assets.codecademy.com/content/paths/web-security/cross-site-request-forgery-attacks/csrf-tokens-dark.png)
