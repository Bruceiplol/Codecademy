# Data Schema
- Database schemas are often drawn as diagrams — big pictures showing every table and how they are connected.
- To assist in keeping track of the database, a schema can be used to help visualize the database and all of its relations.

Free online database design tools:
- DbDiagram.io - a free, simple tool to draw ER diagrams by just writing code, designed for developers and data analysts.
- SQLDBM - SQL Database Modeler
- DB Designer - online database schema design and modeling tool
<br>

Your database schema should contain the following:
- table names
- column names per table
- column types per table
- constraints per table, if any
- relationships between tables, if any

---
## Database Keys
- A database key is a column or group of columns in a table that uniquely identifies a row in a table.
- Keys enable a database designer to place constraints on the data in a table.
- we can avoid duplicity of information and strictly maintain relationships between tables.
- There are many types of keys: Super, Candidate, Primary, Foreign, Composite, and Secondary.

### Primary Key
- A primary key is a designation that applies to a column or multiple columns of a table that uniquely identifies each row in the table.
- Designating a primary key on a particular column in a table ensures that this column data is always unique and not null.

```sql
CREATE TABLE recipe (
  id integer PRIMARY KEY,
  name varchar(20),
  ...
);
```

#### Key Validation
##### Information Schema
-  information schema is a database containing meta information about objects in the database including tables, columns and constraints. This schema provides users with read-only views of many topics of interest.

<br>
Suppose you would like to find out the constraints that have been placed on certain columns in a table, such as recipe, you would type the following query.

```sql
SELECT
  constraint_name, table_name, column_name
FROM
  information_schema.key_column_usage
WHERE
  table_name = 'recipe';
  ```
  ```
  //output
   constraint_name | table_name | column_name 
-----------------+------------+-------------
 recipe_pkey     | recipe     | id
(1 row)
```

- The `constraint_name` value, such as `recipe_pkey`, is generated by default to begin with a table name followed by the type of constraint.
- `pkey` refers to a primary key constraint, while `fkey` refers to a foreign key constraint.

##### Composite Primary Key
- Sometimes, none of the columns in a table can uniquely identify a record.
- When this happens, we can designate multiple columns in a table to serve as the primary key, also known as a composite primary key.

```sql
PRIMARY KEY (column_one, column_two)
```

```sql
CREATE TABLE popular_recipes (
  recipe_id varchar(20),
  ingredient_id varchar(20),
  downloaded integer,
  PRIMARY KEY (recipe_id, ingredient_id)
);
```

### Foreign Key 
- A foreign key is a key that references a column in another table.
- set foreign keys in dependant table (email) links to independant table (person)

```sql
CREATE TABLE person (
  id integer PRIMARY KEY,
  name varchar(20),
  age integer
);

CREATE TABLE email (
  email varchar(20) PRIMARY KEY,
  person_id integer REFERENCES person(id),
  storage integer,
  price money
);
```

suppose that we want to join the person and email tables from the following schema back together:
```sql
SELECT person.name AS name, email.email AS email
FROM person, email
WHERE person.id = email.person_id;
```

---
## Database Relationships
- A database relationship establishes the way in which connected tables are dependent on one another.
- There are three types: one-to-one, one-to-many and many-to-many.

### One-to-One Relationship
- In a one-to-one relationship, a row of table A is associated with exactly one row of table B and vice-versa.
- For example, a driver may only have one driver’s license issued to them in their home state.
- To establish a one-to-one relationship in PostgreSQL between these two tables, we need to designate a foreign key in one of the tables.
- To enforce a strictly one-to-one relationship in PostgreSQL, we need another keyword, `UNIQUE`

```sql
CREATE TABLE driver (
    license_id char(20) PRIMARY KEY,
    name varchar(20),
    address varchar(100),
    date_of_birth date
);      

CREATE TABLE license (
    id integer PRIMARY KEY,
    state_issued varchar(20),
    date_issued date,
    date_expired  date,
    license_id char(20) REFERENCES driver(license_id) UNIQUE
);
```

### One-to-Many Relationship
- We need to represent a one-to-many relationship with two tables - a parent and a child table.
- a parent can have multiple children, a parent table will house a primary key and the child table will house both primary and foreign keys.
- The foreign key binds the child table to the parent table.
-  Parent table will not include the childrens'ids but children tables will hold the parent id

### Many-to-Many Relationship
- For example, A student can take many courses while a course can have enrollments from many students.
- To implement a many-to-many relationship in a relational database, we would create a third cross-reference table also known as a join table.
- Join talbe have two constraints:
  - foreign keys referencing the primary keys of the two member tables.
  - a composite primary key made up of the two foreign keys.
<br>
Example:
- recipe table: id (primary key), name, ...
- ingredient table: id(primary key), name, ...
- recipes_ingredients table (third cross-reference): recipe_id (foreign key referencing recipe table id), ingredient_id (foreign key referencing ingredient table id)

---
## Entity Relationship Diagram
- An Entity Relationship Diagram (ERD) is a method of diagramming a database with a little more description put into it to allow a designer to better understand the database and the relationships between the tables.
- items:
  - Entities: rectangles, indicate the table’s name.
  - Attributes: oval, the individual columns that will be found within that table or entity.
  - Actions: diamonds, describe the relationships between different entities. For instance, if we have two entities, a Customer and a Credit Card that are both connected, we can put an action in between those two that says “has” to show the designer that a Customer has a Credit Card.
  - Connecting Lines: show the connection between each entity, action, and attribute.
